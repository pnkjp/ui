<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Pronunciation Practice</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 2em;
      background-color: #f0f0f0;
      max-width: 600px;
      margin: auto;
    }
    textarea {
      width: 100%;
      height: 200px;
      font-size: 16px;
    }
    button {
      padding: 10px 20px;
      font-size: 16px;
      margin-top: 10px;
    }
    #status {
      margin-top: 20px;
      font-weight: bold;
    }
    .result {
      margin-top: 10px;
      background: #fff;
      padding: 10px;
      border-radius: 5px;
      font-size: 16px;
      box-shadow: 0 0 4px rgba(0,0,0,0.1);
    }
  </style>
</head>
<body>

  <h2>üó£Ô∏è Pronunciation Practice Tool</h2>

  <p>Enter words (one per line):</p>
  <textarea id="wordPool" placeholder="e.g. banana&#10;elephant&#10;dolphin"></textarea><br>
  <button onclick="startSession()">Start Practice</button>
  <p id="status"></p>
  <div id="results"></div>

  <script>
    const synth = window.speechSynthesis;
    const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
    recognition.lang = 'en-US';
    recognition.interimResults = false;
    recognition.continuous = false; // We'll manually restart
  
    function speakWord(word, callback) {
      const utterance = new SpeechSynthesisUtterance(word);
      utterance.rate = 0.9;
      utterance.onend = callback;
      synth.speak(utterance);
    }
  
    function recognizeOnce(callback) {
      recognition.onresult = (event) => {
        const transcript = event.results[0][0].transcript;
        callback(transcript);
      };
  
      recognition.onerror = (event) => {
        callback(`(Recognition error: ${event.error})`);
      };
  
      recognition.onend = () => {
        // We will manually restart next time; nothing to do here
      };
  
      recognition.start();
    }
  
    function startSession() {
      const words = document.getElementById("wordPool").value
        .split('\n')
        .map(w => w.trim())
        .filter(Boolean);
  
      const status = document.getElementById("status");
      const results = document.getElementById("results");
      results.innerHTML = "";
  
      if (!words.length) {
        status.textContent = "Please enter some words.";
        return;
      }
  
      let index = 0;
  
      function nextWord() {
        if (index >= words.length) {
          status.textContent = "‚úÖ Practice complete!";
          return;
        }
  
        const word = words[index];
        status.textContent = `üéß Listening for: "${word}"`;
  
        speakWord(word, () => {
          setTimeout(() => {
            status.textContent = `üé§ Please repeat: "${word}"`;
            recognizeOnce((spoken) => {
              const result = document.createElement("div");
              result.className = "result";
              result.innerHTML = `<strong>Word:</strong> ${word}<br><strong>You said:</strong> ${spoken}`;
              results.appendChild(result);
  
              index++;
              setTimeout(nextWord, 2000);
            });
          }, 500);
        });
      }
  
      nextWord();
    }
  </script>
  

</body>
</html>
